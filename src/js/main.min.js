var config={api_endpoint:"http://api.planlab.wolkenmachine.nl/"},Models={},model={get:function(n,t,o){m.request({method:"GET",url:config.api_endpoint+n}).then(o)},post:function(n,t,o){m.request({method:"POST",url:config.api_endpoint+n,data:t}).then(o)}};Models.Program=function(){function n(){model.get("domain",{},function(n){r=n})}function t(t,o,e){model.post("program",{name:t,mission:o},function(t){n(),e(t.id)})}function o(t,o,e,r){model.post("program/"+t,{name:o,mission:e},function(t){n(),r(t.id)})}function e(){return r}var r=[];return{newItem:t,updateItem:o,loadContent:n,getContent:e}}(),Models.Task=function(){function n(){model.get("program/"+u,{},function(n){m=n.Tasks,i=n.name})}function t(){return m}function o(){return i}function e(t){t!==u&&(u=t,t>0&&n())}function r(t,o,e){model.post("task",{program:u,name:t,means:o},function(t){n(),e(t.id)})}function a(t,o,e,r){model.post("task/"+t,{name:o,means:e},function(t){n(),r(t.id)})}var u=-1,m=[],i="";return{newItem:r,updateItem:a,loadContent:n,getContent:t,getName:o,updateContent:e}}(),Models.Effort=function(){function n(){model.get("task/"+u,{},function(n){m=n.Efforts,i=n.name})}function t(){return m}function o(){return i}function e(t){t!==u&&(u=t,t>0&&n())}function r(t,o,e,r){model.post("effort",{task:u,name:t,type:o,people:e},function(t){n(),r(t.id)})}function a(t,o,e,r,a){model.post("effort/"+t,{name:o,type:e,people:r},function(t){n(),a(t.id)})}var u=-1,m=[],i="";return{newItem:r,updateItem:a,loadContent:n,getContent:t,getName:o,updateContent:e}}(),Models.Person=function(){function n(){model.get("people",{},function(n){a=n})}function t(){return a}function o(){model.get("teams",{},function(n){u=n})}function e(){return u}function r(t,o){model.post("person",{name:t},function(t){n(),o(t)})}var a=[],u=[];return{loadPeople:n,getPeople:t,loadTeams:o,getTeams:e,newItem:r}}(),Models.Changes=function(){function n(){model.get("changes",{},function(n){e=n.map(function(n){return n.new=!1,n.updatedAt==n.createdAt&&(n.new=!0),n.date=o(new Date(n.updatedAt)),n.task=n.Tasks[0].name,n.program=n.Tasks[0].Programs[0].name,n})})}function t(){return e}function o(n){var t=Math.floor((new Date-n)/1e3),o=Math.floor(t/31536e3);return o>1?o+" jaar":(o=Math.floor(t/2592e3))>1?o+" maanden":(o=Math.floor(t/604800))>1?o+" weken":(o=Math.floor(t/86400))>1?o+" dagen":(o=Math.floor(t/3600))>1?o+" uur":(o=Math.floor(t/60),o>1?o+" minuten":Math.floor(t)+" seconden")}var e=[];return{loadContent:n,getContent:t}}(),Models.Search=function(){function n(){model.get("search",{},function(n){o=n.map(function(n){return n.task=n.Tasks[0].name,n.program=n.Tasks[0].Programs[0].name,n})})}function t(){return o}var o=[];return{loadContent:n,getContent:t}}();var viewModels={};viewModels.Hierarchy=function(){function n(n){f=n,c=-1,d=-1,Models.Task.updateContent(f)}function t(){return f}function o(){var n=Models.Program.getContent();return n.length>0&&f>0?n[f].name:""}function e(n){c=n,d=-1,Models.Effort.updateContent(c)}function r(){return c}function a(n){d=n}function u(){return d}function m(n){console.log(n),s=n}function i(t,o,r){n(t),e(o),a(r)}var f=-1,c=-1,d=-1,s=-1;return{updatePerson:m,updateProgram:n,updateTask:e,updateEffort:a,getProgram:t,getTask:r,getEffort:u,getProgramName:o,jumpTo:i}}();var API_VERSION="0.1.0";model.get("",{},function(n){n.version!==API_VERSION?(console.log("out of sync!"),location.reload(!0)):m.route(document.body,"/",{"/":Page})});var NavBar=function(){return{view:function(n){return m("nav",[m(".nav-dashbutton",[m(".nav-dashbutton-icon")])])}}},ProgramBar=function(){return Models.Program.loadContent(),{view:function(n){var t=1;return m(".programbar",[Models.Program.getContent().map(function(n){return m(".programbar-domain",[n.Programs.map(function(n){return m(".programbar-program",[m(".programbar-program-number.button-number",t++),m(".programbar-program-title",n.name)])})])})])}}},Page=function(){return{view:function(n){return[m(".layout-nav-top",m(NavBar)),m(".layout-nav-left",m(ProgramBar)),m(".layout-workspace","sadf")]}}};